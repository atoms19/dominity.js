var v=function(J){return new L(J)},c=function(J){return new V(J)},s=function(J){let Q=[];return document.querySelectorAll(J).forEach((W)=>{Q.push(new V(W))}),Q};var I=function(){O++},S=function(){if(O>1){O--;return}let J,Q=!1;while(j!==void 0){let W=j;j=void 0,M++;while(W!==void 0){const Z=W._nextBatchedEffect;if(W._nextBatchedEffect=void 0,W._flags&=~K,!(W._flags&B)&&k(W))try{W._callback()}catch(X){if(!Q)J=X,Q=!0}W=Z}}if(M=0,O--,Q)throw J};var G=function(J){const Q=Y;Y=void 0;try{return J()}finally{Y=Q}},h=function(J){if(Y===void 0)return;let Q=J._node;if(Q===void 0||Q._target!==Y){if(Q={_version:0,_source:J,_prevSource:Y._sources,_nextSource:void 0,_target:Y,_prevTarget:void 0,_nextTarget:void 0,_rollbackNode:Q},Y._sources!==void 0)Y._sources._nextSource=Q;if(Y._sources=Q,J._node=Q,Y._flags&P)J._subscribe(Q);return Q}else if(Q._version===-1){if(Q._version=0,Q._nextSource!==void 0){if(Q._nextSource._prevSource=Q._prevSource,Q._prevSource!==void 0)Q._prevSource._nextSource=Q._nextSource;Q._prevSource=Y._sources,Q._nextSource=void 0,Y._sources._nextSource=Q,Y._sources=Q}return Q}return},L=function(J){this._value=J,this._version=0,this._node=void 0,this._targets=void 0},k=function(J){for(let Q=J._sources;Q!==void 0;Q=Q._nextSource)if(Q._source._version!==Q._version||!Q._source._refresh()||Q._source._version!==Q._version)return!0;return!1},N=function(J){for(let Q=J._sources;Q!==void 0;Q=Q._nextSource){const W=Q._source._node;if(W!==void 0)Q._rollbackNode=W;if(Q._source._node=Q,Q._version=-1,Q._nextSource===void 0){J._sources=Q;break}}},C=function(J){let Q=J._sources,W=void 0;while(Q!==void 0){const Z=Q._prevSource;if(Q._version===-1){if(Q._source._unsubscribe(Q),Z!==void 0)Z._nextSource=Q._nextSource;if(Q._nextSource!==void 0)Q._nextSource._prevSource=Z}else W=Q;if(Q._source._node=Q._rollbackNode,Q._rollbackNode!==void 0)Q._rollbackNode=void 0;Q=Z}J._sources=W},F=function(J){L.call(this,void 0),this._fn=J,this._sources=void 0,this._globalVersion=T-1,this._flags=q},m=function(J){return new F(J)},E=function(J){const Q=J._cleanup;if(J._cleanup=void 0,typeof Q==="function"){I();const W=Y;Y=void 0;try{Q()}catch(Z){throw J._flags&=~H,J._flags|=B,R(J),Z}finally{Y=W,S()}}},R=function(J){for(let Q=J._sources;Q!==void 0;Q=Q._nextSource)Q._source._unsubscribe(Q);J._fn=void 0,J._sources=void 0,E(J)},u=function(J){if(Y!==this)throw new Error("Out-of-order effect");if(C(this),Y=J,this._flags&=~H,this._flags&B)R(this);S()},U=function(J){this._fn=J,this._cleanup=void 0,this._sources=void 0,this._nextBatchedEffect=void 0,this._flags=P},x=function(J){const Q=new U(J);try{Q._callback()}catch(W){throw Q._dispose(),W}return Q._dispose.bind(Q)},g=Symbol.for("preact-signals"),H=1,K=2,q=4,B=8,A=16,P=32,Y=void 0,j=void 0,O=0,M=0,T=0;L.prototype.brand=g;L.prototype._refresh=function(){return!0};L.prototype._subscribe=function(J){if(this._targets!==J&&J._prevTarget===void 0){if(J._nextTarget=this._targets,this._targets!==void 0)this._targets._prevTarget=J;this._targets=J}};L.prototype._unsubscribe=function(J){if(this._targets!==void 0){const{_prevTarget:Q,_nextTarget:W}=J;if(Q!==void 0)Q._nextTarget=W,J._prevTarget=void 0;if(W!==void 0)W._prevTarget=Q,J._nextTarget=void 0;if(J===this._targets)this._targets=W}};L.prototype.subscribe=function(J){return x(()=>{const Q=this.value,W=Y;Y=void 0;try{J(Q)}finally{Y=W}})};L.prototype.valueOf=function(){return this.value};L.prototype.toString=function(){return this.value+""};L.prototype.toJSON=function(){return this.value};L.prototype.peek=function(){const J=Y;Y=void 0;try{return this.value}finally{Y=J}};Object.defineProperty(L.prototype,"value",{get(){const J=h(this);if(J!==void 0)J._version=this._version;return this._value},set(J){if(J!==this._value){if(M>100)throw new Error("Cycle detected");this._value=J,this._version++,T++,I();try{for(let Q=this._targets;Q!==void 0;Q=Q._nextTarget)Q._target._notify()}finally{S()}}}});F.prototype=new L;F.prototype._refresh=function(){if(this._flags&=~K,this._flags&H)return!1;if((this._flags&(q|P))===P)return!0;if(this._flags&=~q,this._globalVersion===T)return!0;if(this._globalVersion=T,this._flags|=H,this._version>0&&!k(this))return this._flags&=~H,!0;const J=Y;try{N(this),Y=this;const Q=this._fn();if(this._flags&A||this._value!==Q||this._version===0)this._value=Q,this._flags&=~A,this._version++}catch(Q){this._value=Q,this._flags|=A,this._version++}return Y=J,C(this),this._flags&=~H,!0};F.prototype._subscribe=function(J){if(this._targets===void 0){this._flags|=q|P;for(let Q=this._sources;Q!==void 0;Q=Q._nextSource)Q._source._subscribe(Q)}L.prototype._subscribe.call(this,J)};F.prototype._unsubscribe=function(J){if(this._targets!==void 0){if(L.prototype._unsubscribe.call(this,J),this._targets===void 0){this._flags&=~P;for(let Q=this._sources;Q!==void 0;Q=Q._nextSource)Q._source._unsubscribe(Q)}}};F.prototype._notify=function(){if(!(this._flags&K)){this._flags|=q|K;for(let J=this._targets;J!==void 0;J=J._nextTarget)J._target._notify()}};Object.defineProperty(F.prototype,"value",{get(){if(this._flags&H)throw new Error("Cycle detected");const J=h(this);if(this._refresh(),J!==void 0)J._version=this._version;if(this._flags&A)throw this._value;return this._value}});U.prototype._callback=function(){const J=this._start();try{if(this._flags&B)return;if(this._fn===void 0)return;const Q=this._fn();if(typeof Q==="function")this._cleanup=Q}finally{J()}};U.prototype._start=function(){if(this._flags&H)throw new Error("Cycle detected");this._flags|=H,this._flags&=~B,E(this),N(this),I();const J=Y;return Y=this,u.bind(this,J)};U.prototype._notify=function(){if(!(this._flags&K))this._flags|=K,this._nextBatchedEffect=j,j=this};U.prototype._dispose=function(){if(this._flags|=B,!(this._flags&H))R(this)};var b=function(J,...Q){let W=document.createElement(J),Z=new V(W);return Q.forEach((X,w)=>{if(typeof X=="string"){let z=document.createTextNode(X);W.appendChild(z)}else if(typeof X=="function"&&typeof X()=="string"){let z=document.createTextNode(X());$(()=>{z.data=X()}),W.appendChild(z)}else if(X instanceof _){let z=document.createTextNode(X.value);W.appendChild(z),$(()=>{z.data=X.value})}else if(X instanceof V)W.appendChild(X.elem);else if(typeof X=="object"||typeof X=="function"&&typeof X()=="object")Z.attr(X);else if(X instanceof Array)X.forEach((z)=>{if(z instanceof V)W.appendChild(z.elem);else throw new Error("Dominity Error: invalid element type passed in as array ,all elements of the array should be of type DominityElement")});else throw new Error(`Dominity Error: invalid type ${typeof X} passed in as argument to dominity builder function`)}),Z},$=x,D=v,f=m,_=L;class V{constructor(J){if(typeof J=="string")this.elem=document.querySelector(J);else this.elem=J;if(this.elem==null){console.error(`DominityError: element of query '${J}'  NOT  FOUND `);return}}html(J){if(J==null)return this.elem.innerHTML;else{if(typeof J=="function")$(()=>{this.html(J())});else this.elem.innerHTML=J;return this}}css(J,Q=void 0){if(typeof J=="string")if(Q==null)return window.getComputedStyle(this.elem,null).getPropertyValue(J);else return this.elem.style[J]=Q,this;else if(typeof J=="object")return Object.assign(this.elem.style,J),this;else if(typeof J=="function")return $(()=>{this.css(J())}),this}attr(J,Q=void 0){if(typeof J=="string")if(Q==null)return this.elem.getAttribute(J);else return this.elem.setAttribute(J,Q),this;else if(typeof J=="object"){let W=Object.keys(J),Z=Object.values(J);return W.forEach((X,w)=>{if(Z[w]instanceof _)$(()=>{this.attr(X,Z[w].value)});else if(typeof Z[w]!="function")this.attr(X,Z[w]);else if(typeof Z[w]=="function")$(()=>{this.attr(X,Z[w]())})}),this}}bindClass(J,Q,W){return $(()=>{if(J.value){if(this.elem.classList.add(...Q.split(" ")),W!=null)this.elem.classList.remove(...W.split(" "))}else if(this.elem.classList.remove(...Q.split(" ")),W!=null)this.elem.classList.add(...W.split(" "))}),this}on(J,Q,W=!1){return this.elem.addEventListener(J,Q,W),this}remove(){return this.elem.remove(),this}showIf(J){let Q=this.css("display")!="none"?this.css("display"):"block";if(typeof J=="function")return $(()=>{this.showIf(J())}),this;else if(J instanceof _)$(()=>{this.showIf(J.value)});else if(J)this.elem.style.display=Q;else this.elem.style.display="none";return this}forEvery(J,Q){let W=this;if(J instanceof _)return $(()=>{W.elem.innerHTML="",J.value.forEach((Z,X)=>{G(()=>{let w=Q(Z,X,W);if(w)w.addTo(this.elem)})})}),this;return console.error("DominityError: list item for .forEvery has to be a reactive object made with state() and iterable"),this}withRef(J){return J(this.elem,this),this}giveRef(J,Q=!0){if(J instanceof _)J.value=Q?this.elem:this;else J=Q?this.elem:this;return this}model(J,Q){let W="value";if(this.attr("type")=="checkbox")W="checked";if(J instanceof _){if(Q?.debounce==null&&Q?.throttle==null)$(()=>{if(!(J.value instanceof Array))this.elem[W]=J.value;else if(J.value.includes(this.elem.name))this.elem[W]=!0;else this.elem[W]=!1});else this.elem[W]=J.value;let Z,X=0;this.on("input",()=>{let w=this.elem.value;if(this.attr("type")=="number"){if(w=="")w="0";w=parseFloat(w)}if(W=="checked")if(!(J.value instanceof Array))if(this.elem.checked)w=!0;else w=!1;else if(this.elem.checked)w=[...J.value,this.elem.name];else w=J.value.filter((z)=>z!=this.elem.name);if(Q?.debounce==null&&Q?.throttle==null)J.value=w;else if(Q?.debounce)clearTimeout(Z),Z=setTimeout(()=>{J.value=w},Q?.debounce);else if(Q?.throttle){const z=(new Date()).getTime();if(z-X<Q?.throttle)return;X=z,J.value=w}})}return this}animate(J,Q,W="linear",Z=void 0){let X={};Object.keys(J).forEach((z)=>{if(J[z]instanceof Array)X[z]=J[z][0],J[z]=J[z][1];else X[z]=this.css(z)});let w=this.elem.animate([X,J],{duration:Q*1000,easing:W,fill:"forwards"});return w.onfinish=()=>{if(this.css(J),typeof Z==="function")Z(this)},this}addTo(J){if(J.dominityElem)J.addChild(this);else J.appendChild(this.elem);return this}child(J){return new V(this.elem.children[J])}extend(J){return Object.assign(this,J),this}}class y{constructor(){this.routeMap={},this.defaultPath=void 0}setRoutes(J={}){Object.keys(J).forEach((Q)=>{let W={},Z=J[Q];if(W.viewKey=D(Z.isDefault!=null&&Z.isDefault),Z.isDefault!=null&&Z.isDefault)this.defaultPath=Q;if(J[Q].component instanceof V)J[Q].component.showIf(W.viewKey);if(J[Q].getComponent!=null&&typeof J[Q].getComponent=="function")$(async()=>{if(W.viewKey.value){let X=await G(async()=>await J[Q].getComponent(this));if(J[Q].layout!=null)X=J[Q].layout(X);this.root.appendChild(X.withRef((w)=>{$(()=>{if(J[Q].componentLoaded=w,J[Q].onLoad!=null)G(()=>J[Q].onLoad(w));if(this.onLoad!=null)G(this.onLoad)})}).elem)}else if(J[Q].componentLoaded)J[Q].componentLoaded.remove()});this.routeMap[Q]=W})}start(J){if(J instanceof V)this.root=J.elem;else this.root=J;addEventListener("popstate",()=>{setTimeout(()=>{this.assignRoute()},100)}),addEventListener("load",async()=>{setTimeout(()=>{if(window.location.pathname=="/"||window.location.pathname==this.defaultAltPath)this.routeTo(this.defaultPath);else this.assignRoute()},200)}),this.assignRoute()}async assignRoute(){Object.keys(this.routeMap).forEach((J)=>{let Q=this.routeMap[J];if(window.location.pathname==J)Q.viewKey.value=!0;else Q.viewKey.value=!1})}routeTo(J){history.pushState(null,"",J),this.assignRoute()}replaceRoute(J){history.replaceState(null,"",J),this.assignRoute()}revalidateRoute(){history.go(0),this.assignRoute()}Link({href:J,replace:Q,...W},...Z){return b("a",{...W},...Z).on("click",(X)=>{if(X.preventDefault(),Q!=null)this.replaceRoute(X.target.getAttribute("href"));else this.routeTo(J)})}get queries(){return Object.fromEntries(new URLSearchParams(window.location.search).entries())}}var i=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rb","rp","rt","rtc","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","u","ul","var","video","wbr","slot"],d=i.reduce((J,Q)=>{return J[Q]=(...W)=>{let Z=b(Q,...W);return J.root.appendChild(Z.elem),Z},J},{root:document.body});window.D={...d,effect:(J)=>$(J),derived:f,state:D,DominityReactive:_,$el:c,$$el:s,DominityRouter:y,DominityElement:V,el:b};
